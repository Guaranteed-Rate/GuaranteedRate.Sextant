name: Build

on:
  push:
    branches: [ ci-cd ]

jobs:
  build:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2
    - name: Install dependencies
      run: dotnet restore
    - name: Build
      run: dotnet build GuaranteedRate.Sextant\GuaranteedRate.Sextant.csproj --configuration Release --no-restore
    - name: Setup Nuget.exe
      uses: warrenbuckley/Setup-Nuget@v1
    - name: Add GPR Source
      run: nuget sources add -name "GPR" -Source https://nuget.pkg.github.com/guaranteed-rate/index.json -Username Guaranteed-Rate -Password ${{ secrets.GITHUB_TOKEN }}
    - name: nuget push
      run: nuget push GuaranteedRate.Sextant\bin\release\*.nupkg -Source "GPR" -SkipDuplicate
